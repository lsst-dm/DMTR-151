\documentclass[DM,lsstdraft,STR,toc]{lsstdoc}
\usepackage{geometry}
\usepackage{longtable,booktabs}
\usepackage{enumitem}
\usepackage{arydshln}

\input meta.tex

\providecommand{\tightlist}{
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\begin{document}

\def\milestoneName{Summit - Base Network Integration}
\def\milestoneId{LVV-P47}
\def\product{Networks}

\setDocCompact{true}

\title{ LVV-P47 Summit - Base Network Integration Test Plan and Report}
\setDocRef{\lsstDocType-\lsstDocNum}
\date{\vcsdate}
\setDocUpstreamLocation{\url{https://github.com/lsst/lsst-texmf/examples}}
\author{ Jeff Kantor }

\input history_and_info.tex


\setDocAbstract{
This is the test plan and report for LVV-P47 (Summit - Base Network Integration), an LSST level 2 milestone pertaining to the Data Management Subsystem.
}


\maketitle

\section{Introduction}
\label{sect:intro}


\subsection{Objectives}
\label{sect:objectives}

This test plan documents the Summit - Base Network Integration test
activity.



\subsection{System Overview}
\label{sect:systemoverview}

The Summit - Base Network is defined in \citeds{LSE-78} and \citeds{LSE-309}


\subsection{Document Overview}
\label{sect:docoverview}

This document was generated from Jira, obtaining the relevant information from the 
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testPlan/LVV-P47}{LVV-P47}
~Jira Test Plan and related Test Cycles (
  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCycle/LVV-C82}{LVV-C82}
).

Section \ref{sect:intro} provides an overview of the test campaign, the system under test (\product{}), the applicable documentation, and explains how this document is organized.
Section \ref{sect:configuration}  describes the configuration used for this test.
Section \ref{sect:personnel} describes the necessary roles and lists the individuals assigned to them.
%Section \ref{sect:plannedtestactivities} provides the list of planned test cycles and test cases, including all relevant information that fully describes the test campaign.

Section \ref{sect:overview} provides a summary of the test results, including an overview in Table \ref{table:summary}, an overall assessment statement and suggestions for possible improvements.
Section \ref{sect:detailedtestresults} provides detailed results for each step in each test case.

The current status of test plan LVV-P47 in Jira is \textbf{ Completed }.

\subsection{References}
\label{sect:references}
\renewcommand{\refname}{}
\bibliography{lsst,refs,books,refs_ads}
\section{Test Configuration}
\label{sect:configuration}

\subsection{Data Collection}

  Observing is not required for this test campaign.

\subsection{Verification Environment}
\label{sect:hwconf}
  Summit - Base Network integration is verified in the actual Cerro Pachon
summit and La Serena Base, as well as on the fiber route between them.
~The integration is done in 3 phases ~(in collaboration with
equipment/installation vendors):

\begin{enumerate}
\tightlist
\item
  Installation of fiber optic cables and Optical Time Domain Reflector
  (OTDR) fiber testing (completed 20170602
  \href{https://docushare.lsstcorp.org/docushare/dsweb/Get/Document-26270/RD10\%20Report\%20of\%20delivery\%20of\%20LS\%20-\%20AG\%20fiber\%20from\%20Telefonica\%20to\%20REUNA.pdf}{REUNA
  deliverable RD10})
\item
  Installation of AURA DWDM and Data Transfer Node (DTN) (completed
  20171218 \citeds{DMTR-82})
\item
  Installation of LSST DWDM and Bit Error Rate Tester (BERT) data
  (completed 20190505
  \href{https://docushare.lsstcorp.org/docushare/dsweb/View/Collection-7743}{collection-7743})
\end{enumerate}


  \subsection{Entry Criteria}
  By phase:

\begin{enumerate}
\tightlist
\item
  Posts from Cerro Pachon to AURA Gatehouse repaired/improved. ~Fiber
  installed on posts from Cerro Pachon to AURA Gatehouse. ~Fiber
  installed from AURA Gatehouse to AURA compound in La Serena. OTDR
  purchased.
\item
  AURA DWDM installed in caseta on Cerro Pachon and in existing computer
  room in La Serena. ~DTN installed in La Serena. ~DTN loaded with
  software and test data staged.
\item
  Base Data Center (BDC) ready for installation of LSST DWDM. ~Fiber
  connecting existing computer room to BDC. ~LSST DWDM equipment
  installed in Summit Computer Room and BDC.
\end{enumerate}


  \subsection{Exit Criteria}
  By phase:

\begin{enumerate}
\tightlist
\item
  Fiber tested to within acceptable Db.
\item
  Summit - Base bandwidth and latency within specifications
\item
  Summit - Base bandwidth, latency, bit error rate within specifications
\end{enumerate}


  \subsection{PMCS Activity}
  By phase:

\begin{enumerate}
\tightlist
\item
  DMTC-8000-0806
\item
  DMTC-8000-0826
\item
  DMTC-8000-0836
\end{enumerate}


\newpage
\section{Personnel}
\label{sect:personnel}

The following personnel are involved in this test activity:

\begin{itemize}
\item Test Plan (LVV-P47) owner: Jeff Kantor
\item Test Cycles:
\begin{itemize}
  \item LVV-C82 owner: 
    Jeff Kantor
  \begin{itemize}
    \item Test case \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1168}{LVV-T1168} tester: Jeff Kantor
  \end{itemize}
\end{itemize}
\item Additional Test Personnel involved:
  \begin{itemize}
    \item Test case \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1168}{LVV-T1168}: Ron Lambert (LSST), Albert Astudillo (REUNA), Mauricio Rojas
(CTIO/CISS), Raylex, Coriant, Telefonica contractors

  \end{itemize}
\end{itemize}

\newpage

\section{Overview of the Test Results}
\label{sect:overview}

\subsection{Summary}
\label{sect:summarytable}

\begin{longtable}{p{0.12\textwidth}p{0.2\textwidth}p{0.56\textwidth}p{0.12\textwidth}}
\toprule

  \multicolumn{3}{c}{ Test Cycle {\bf LVV-C82: Summit - Base Network Integration
 }} \\\hline

  {\bf \footnotesize test case} & {\bf \footnotesize status} & {\bf \footnotesize comment} & {\bf \footnotesize issues} \\\toprule

    \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1168}{LVV-T1168}
    & Pass & Tests conducted in 3 phases, each phase passed. ~Phase 2 was limited by
Data Transfer Node capacity to put data onto the network; still passed
but could not keep increasing data rate to find top limit.
 &
    \\\hline

\caption{Test Results Summary}
\label{table:summary}
\end{longtable}

\subsection{Overall Assessment}
\label{sect:overallassessment}

Passed


\subsection{Recommended Improvements}
\label{sect:recommendations}

None


\newpage
\section{Detailed Test Results}
\label{sect:detailedtestresults}


  \subsection{Test Cycle LVV-C82 }

Open test cycle {\it \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testrun/LVV-C82}{Summit - Base Network Integration
}} in Jira.

  Summit - Base Network Integration
\\
  Status: Done

  This test cycle covers the Summit - Base Network Integration test
activity.


  \subsubsection{Software Version/Baseline}
    By phase:\\

\begin{enumerate}
\tightlist
\item
  Optical Time Domain Reflector (OTDR) firmware/configuration/plots/logs
  documented in
  \href{https://docushare.lsstcorp.org/docushare/dsweb/Get/Document-26270/RD10\%20Report\%20of\%20delivery\%20of\%20LS\%20-\%20AG\%20fiber\%20from\%20Telefonica\%20to\%20REUNA.pdf}{REUNA
  deliverable RD10}
\item
  Data Transfer Node (DTN) software/configuration/data documented in
  \citeds{DMTR-82}
\item
  Bit Error Rate Tester (BERT) firmware/configuration/plots/logs
  documented in
  \href{https://docushare.lsstcorp.org/docushare/dsweb/View/Collection-7743}{collection-7743}
\end{enumerate}


  \subsubsection{Configuration}
    By phase:\\

\begin{enumerate}
\tightlist
\item
  Optical Time Domain Reflector (OTDR) firmware/configuration/plots/logs
  documented in
  \href{https://docushare.lsstcorp.org/docushare/dsweb/Get/Document-26270/RD10\%20Report\%20of\%20delivery\%20of\%20LS\%20-\%20AG\%20fiber\%20from\%20Telefonica\%20to\%20REUNA.pdf}{REUNA
  deliverable RD10}
\item
  Data Transfer Node (DTN) software/configuration/data documented in
  \citeds{DMTR-82}
\item
  Bit Error Rate Tester (BERT) firmware/configuration/plots/logs
  documented in
  \href{https://docushare.lsstcorp.org/docushare/dsweb/View/Collection-7743}{collection-7743}
\end{enumerate}


  \subsubsection{Test Cases in LVV-C82 Test Cycle}


    \paragraph{Test Case LVV-T1168 - Test Summit - Base Network Integration
 }\mbox{}\\

Open  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1168}{\textit{ LVV-T1168 } }
test case in Jira.

    3 phases done (in collaboration with equipment/installation vendors):

\begin{enumerate}
\tightlist
\item
  Installation of fiber optic cables and Optical Time Domain Reflector
  (OTDR) fiber testing (completed 20170602
  \href{https://docushare.lsstcorp.org/docushare/dsweb/Get/Document-26270/RD10\%20Report\%20of\%20delivery\%20of\%20LS\%20-\%20AG\%20fiber\%20from\%20Telefonica\%20to\%20REUNA.pdf}{REUNA
  deliverable RD10})
\item
  Installation of AURA DWDM and Data Transfer Node (DTN) (completed
  20171218 \citeds{DMTR-82})
\item
  Installation of LSST DWDM and Bit Error Rate Tester (BERT) data
  (completed 20190505
  \href{https://docushare.lsstcorp.org/docushare/dsweb/View/Collection-7743}{collection-7743})
\end{enumerate}


    \textbf{ Preconditions}:\\
    By phase:

\begin{enumerate}
\tightlist
\item
  Posts from Cerro Pachon to AURA Gatehouse repaired/improved. ~Fiber
  installed on posts from Cerro Pachon to AURA Gatehouse. ~Fiber
  installed from AURA Gatehouse to AURA compound in La Serena. OTDR
  purchased.
\item
  AURA DWDM installed in caseta on Cerro Pachon and in existing computer
  room in La Serena. ~DTN installed in La Serena. ~DTN loaded with
  software and test data staged.
\item
  Base Data Center (BDC) ready for installation of LSST DWDM. ~Fiber
  connecting existing computer room to BDC. ~LSST DWDM equipment
  installed in Summit Computer Room and BDC.
\end{enumerate}


    Execution status: {\bf Pass }

    Final comment:\\Tests conducted in 3 phases, each phase passed. ~Phase 2 was limited by
Data Transfer Node capacity to put data onto the network; still passed
but could not keep increasing data rate to find top limit.



    Detailed step results:

    \begin{longtable}{p{1cm}p{2cm}p{13cm}}
    \hline
    {Step} & \multicolumn{2}{c}{Description, Results and Status}\\ \hline
      1 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Test optical fiber with OTDR

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      Fiber tested to within acceptable Db.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      \begin{itemize}
\tightlist
\item
  Type of fiber: G.652 PKP-250
\item
  Fiber attenuation: \textless{} 0,25 dB/Km at 1550nm
\item
  Length: 60Kms (approximately) Number of filaments: 4
\end{itemize}

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      2 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Test AURA DWDM

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      Summit - Base bandwidth and latency within specifications

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      The goal was to achieve a minimum of 40 Gbps end to end, up to a maximum
60 Gbps, with the test\\
configuration that we had put in place. Iperf3 was utilized to generate
the sustained data rates. Initial\\
teething problems were encountered which required some days to
troubleshoot and understand, but\\
then the team was ready to perform the test.

The limiting factor in obtaining an optimum capacity of 60 Gbps was
discovered to be due to the NICs in the DTN machines. The processors
were not capable of maintaining a constant 10 Gbps stream and in\\
fact the best we could obtain was approximately 44 Gbps (6x7.5 Gbps) end
to end, sustained over a 24-\\
hour period. However, that more than satisfied our expectations given
the\\
preliminary nature of the testing and the minimum cost spent to optimize
the DTN configurations.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      3 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Test LSST DWDM

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      Summit - Base bandwidth, latency, bit error rate within specifications

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      Summit - Base bandwidth, latency, bit error rate within specifications,
refer to
\href{https://docushare.lsstcorp.org/docushare/dsweb/Get/Document-32765/Mediciones\%20OSA\%20Anillo\%20AURA\%20-\%20LSST.pptx}{Mediciones
OSA Anillo AURA - LSST.pptx} in
docushare~\href{https://docushare.lsstcorp.org/docushare/dsweb/View/Collection-7743}{collection-7743}

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

    \end{longtable}


\input{appendix.tex}
\end{document}
